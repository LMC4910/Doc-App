@model FOS.Shared.AppointmentData
@{
    Layout = null;
}
<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Department</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="~/Content/ClientSideContent/img/favicon.png">
    <!-- Place favicon.ico in the root directory -->
    <!-- CSS here -->
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/owl.carousel.min.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/magnific-popup.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/font-awesome.min.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/themify-icons.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/nice-select.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/flaticon.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/gijgo.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/animate.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/slicknav.css">
    <link rel="stylesheet" href="~/Content/ClientSideContent/css/style2.css">
</head>

<body>
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->
    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div class="header-top_area">
                <div class="container">
                    <div class="row">
                        <div class="col-xl-6 col-md-6 ">
                            <div class="social_media_links">
                                <a href="#">
                                    <i class="fa fa-linkedin"></i>
                                </a>
                                <a href="#">
                                    <i class="fa fa-facebook"></i>
                                </a>
                                <a href="#">
                                    <i class="fa fa-google-plus"></i>
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-6 col-md-6">
                            <div class="short_contact_list">
                                <ul>
                                    <li><a href="#"> <i class="fa fa-envelope"></i> info@docmed.com</a></li>
                                    <li><a href="#"> <i class="fa fa-phone"></i> 160160</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="sticky-header" class="main-header-area">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-xl-3 col-lg-2">
                            <div class="logo">
                                <a href="@Url.Action("Index","Patient")">
                                    <img src="~/Content/ClientSideContent/img/logo.png" alt="">
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-7">
                            <div class="main-menu  d-none d-lg-block">
                                <nav>
                                    <ul id="navigation">
                                        <li><a class="active" href="@Url.Action("Index","Patient")">Home</a></li>
                                        <li><a href="@Url.Action("Department","Patient")">Department</a></li>
                                        <li>
                                            <a href="@Url.Action("Blog","Patient")">blog</a>
                                        </li>
                                        <li><a href="@Url.Action("Doctors","Patient")">Doctors</a></li>
                                        <li><a href="@Url.Action("About","Patient")">About</a></li>
                                        <li><a href="@Url.Action("Contact","Patient")">Contact</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                        <div class="col-xl-3 col-lg-3 d-none d-lg-block">
                            <div class="Appointment">
                                <div class="book_btn d-none d-lg-block">
                                    <a  href="@Url.Action("SearchDoctor","Patient")">Make an Appointment</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- header-end -->
    <!-- bradcam_area_start  -->
    <div class="bradcam_area breadcam_bg bradcam_overlay">
        <div class="container">
            <div class="row">
                <div class="col-xl-12">
                    <div class="bradcam_text">
                        <h3>Services</h3>
                        <p><a href="@Url.Action("Index","Patient")">Home /</a> Services</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- bradcam_area_end  -->
    <!-- Appointment form start -->
    <section class="ftco-section" style="margin-top:5%">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-12 col-md-12">
                    <h2>Availability of <strong id="DrName"></strong></h2>
                    <table class="table table-bordered table-striped appointment-table" id="tblEmployee">
                        <thead>
                            <tr style="background-color:#08c; color:#ffffff">
                                <th rowspan="2" class="text-center">WeekDay</th>
                                <th colspan="2" class="text-center">Starting Time</th>
                                <th colspan="2" class="text-center">Ending Time</th>
                            </tr>
                            <tr></tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

            <div class="row" style="margin-top:3%">
                    <div class="col-12 col-md-12 col-lg-12">
                        <h2>Appointment Form</h2>
                        <div class="card">
                            <div class="card-body">
                                @using (Ajax.BeginForm("GetAppointment", "Patient", new AjaxOptions { OnSuccess = "OnSuccess", OnFailure = "OnFailure" },new { @class="form-horizontal"}))
                                {
                                <div class="row">
                                    @Html.HiddenFor(model => model.DoctorID, new { @class = "form-control", @Value = ViewBag.DocID })
                                    <div class="col-md-12">
                                        <label class="control-label">Patient Name:</label>

                                        <div class="controls">
                                            @Html.TextBoxFor(model => model.PatientName, new { @class = "form-control validate[required]", @placeholder = "Patient Name" })
                                            @*<input type="text" class="form-control validate[required]" placeholder="Patient Name" id="full_name" name="full_name">*@
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <label class="control-label" style="margin-top:4%">Relation</label>
                                        @Html.DropDownList("Relation", new List<SelectListItem>
                                            {
                                                new SelectListItem{ Text="Select Relation", Value = "" },
                                                new SelectListItem{ Text="S/O", Value = "S/O" },
                                                new SelectListItem{ Text="D/O", Value = "D/O" },
                                                new SelectListItem{ Text="W/O", Value = "W/O" },

                                             }, new { @class = "form-control validate[required]", @placeholder = "Relation" })

                                    </div>

                                    <div class="col-md-6">
                                        <label style="margin-top:4%">Relation Name</label><br />
                                        @Html.TextBoxFor(model => model.RelationName, new { @class = "form-control validate[required]", @placeholder = "Relation Name" })
                                    </div>

                                    <div class="col-md-6">
                                        <label style="margin-top:4%">Age:</label><br />
                                        @Html.TextBoxFor(model => model.Age, new { @class = "form-control validate[required]", @placeholder = "Age" })
                                    </div>

                                    <div class="col-md-6">
                                        <label style="margin-top:4%">Gender</label><br />
                                        @Html.DropDownList("Gender", new List<SelectListItem>
                                            {
                                                new SelectListItem{ Text="Select Gender", Value = "" },
                                                new SelectListItem{ Text="Male", Value = "Male" },
                                                new SelectListItem{ Text="Female", Value = "Female" },
                                                new SelectListItem{ Text="Other", Value = "Other" },

                                             }, new { @class = "form-control validate[required]" })
                                    </div>

                                    <div class="col-md-6">
                                        <label class="control-label" style="margin-top:4%">Email:</label><br />
                                        @Html.TextBoxFor(model => model.Email, new { @class = "form-control validate[required]", @type = "email", @placeholder = "Email" })
                                    </div>

                                    <div class="col-md-6">
                                        <label class="control-label" style="margin-top:4%">Contact No:</label><br />
                                        @Html.TextBoxFor(model => model.MobileNo, new { @class = "form-control validate[required]", @placeholder = "Contact No" })
                                        @*<input type="text" class="form-control validate[required, custom[integer], minSize[11]]" placeholder="Contact No" id="contact_no" name="contact_no" required="" maxlength="11">*@
                                    </div>

                                    <div class="col-md-6">
                                        <label class="control-label" style="margin-top:4%">Appointment Date</label><br />
                                        @Html.EditorFor(model => model.AppointmentDate, new { @class = "form-control", @type = "text", @min = (DateTime.Today) })
                                    </div>

                                    <div class="col-md-6">
                                        @*<label for="validationTooltip002">Time: <small style="font-weight:bold; color:red;">18 Slots Available</small> </label>*@
                                        <label class="control-label" style="margin-top:4%">Select Slot</label><br />
                                        @Html.DropDownListFor(model => model.Slot, new SelectList(Model.SlotName, "ID", "Name"), new { @class = "form-control validate[required]" })
                                        @Html.HiddenFor(model => model.SlotID)
                                    </div>

                                    <div class="col-md-12">
                                        <label class="control-label">Address</label>
                                        @Html.TextAreaFor(model => model.Remarks, new { @class = "form-control validate[required]", @rows = "4" })

                                    </div>
                                    <div class="col-md-12">
                                        <button type="submit" id="btnNew" class="btn btn-sm btn-primary" style="width:100%; height:100%; margin-top:1%;">Submit</button>
                                    </div>
                                </div>
                                }
                            </div>
                        </div>
                    </div>
                    </div>  
        </div>
    </section>
    <!-- Appointment form end -->
    <!-- Emergency_contact start -->
    <div class="Emergency_contact" style="margin-top:3%">
        <div class="conatiner-fluid p-0">
            <div class="row no-gutters">
                <div class="col-xl-6">
                    <div class="single_emergency d-flex align-items-center justify-content-center emergency_bg_1 overlay_skyblue">
                        <div class="info">
                            <h3>For Any Emergency Contact</h3>
                            <p>Esteem spirit temper too say adieus.</p>
                        </div>
                        <div class="info_button">
                            <a href="#" class="boxed-btn3-white">+10 378 4673 467</a>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6">
                    <div class="single_emergency d-flex align-items-center justify-content-center emergency_bg_2 overlay_skyblue">
                        <div class="info">
                            <h3>Make an Online Appointment</h3>
                            <p>Esteem spirit temper too say adieus.</p>
                        </div>
                        <div class="info_button">
                            <a href="@Url.Action("SearchDoctor","Patient")" class="boxed-btn3-white">Make an Appointment</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Emergency_contact end -->
    <!-- footer start -->
    <footer class="footer">
        <div class="footer_top">
            <div class="container">
                <div class="row">
                    <div class="col-xl-4 col-md-6 col-lg-4">
                        <div class="footer_widget">
                            <div class="footer_logo">
                                <a href="#">
                                    <img src="~/Content/ClientSideContent/img/footer_logo.png" alt="">
                                </a>
                            </div>
                            <p>
                                Firmament morning sixth subdue darkness
                                creeping gathered divide.
                            </p>
                            <div class="socail_links">
                                <ul>
                                    <li>
                                        <a href="#">
                                            <i class="ti-facebook"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="ti-twitter-alt"></i>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="#">
                                            <i class="fa fa-instagram"></i>
                                        </a>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>
                    <div class="col-xl-2 offset-xl-1 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Departments
                            </h3>
                            <ul>
                                <li><a href="#">Eye Care</a></li>
                                <li><a href="#">Skin Care</a></li>
                                <li><a href="#">Pathology</a></li>
                                <li><a href="#">Medicine</a></li>
                                <li><a href="#">Dental</a></li>
                            </ul>

                        </div>
                    </div>
                    <div class="col-xl-2 col-md-6 col-lg-2">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Useful Links
                            </h3>
                            <ul>
                                <li><a href="@Url.Action("About","Patient")">About</a></li>
                                <li><a href="@Url.Action("Blog","Patient")">Blog</a></li>
                                
                                <li><a href="@Url.Action("Contact","Patient")"> Contact</a></li>
                                <li><a href="@Url.Action("SearchDoctor","Patient")"> Appointment</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xl-3 col-md-6 col-lg-3">
                        <div class="footer_widget">
                            <h3 class="footer_title">
                                Address
                            </h3>
                            <p>
                                200, D-block, Green lane USA <br>
                                +10 367 467 8934 <br>
                                docmed@contact.com
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="copy-right_text">
            <div class="container">
                <div class="footer_border"></div>
                <div class="row">
                    <div class="col-xl-12">
                        <p class="copy_right text-center">
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- footer end  -->
    <!-- link that opens popup -->
    <!-- JS here -->
    <script src="~/Content/ClientSideContent/js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="~/Content/ClientSideContent/js/vendor/jquery-1.12.4.min.js"></script>
    <script src="~/Content/ClientSideContent/js/popper.min.js"></script>
    <script src="~/Content/ClientSideContent/js/bootstrap.min.js"></script>
    <script src="~/Content/ClientSideContent/js/owl.carousel.min.js"></script>
    <script src="~/Content/ClientSideContent/js/isotope.pkgd.min.js"></script>
    <script src="~/Content/ClientSideContent/js/ajax-form.js"></script>
    <script src="~/Content/ClientSideContent/js/waypoints.min.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.counterup.min.js"></script>
    <script src="~/Content/ClientSideContent/js/imagesloaded.pkgd.min.js"></script>
    <script src="~/Content/ClientSideContent/js/scrollIt.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.scrollUp.min.js"></script>
    <script src="~/Content/ClientSideContent/js/wow.min.js"></script>
    <script src="~/Content/ClientSideContent/js/nice-select.min.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.slicknav.min.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.magnific-popup.min.js"></script>
    <script src="~/Content/ClientSideContent/js/plugins.js"></script>
    <script src="~/Content/ClientSideContent/js/gijgo.min.js"></script>
    <!--contact js-->
    <script src="~/Content/ClientSideContent/js/contact.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.ajaxchimp.min.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.form.js"></script>
    <script src="~/Content/ClientSideContent/js/jquery.validate.min.js"></script>
    <script src="~/Content/ClientSideContent/js/mail-script.js"></script>
    <script src="~/Content/ClientSideContent/js/main.js"></script>


    <script>
                    //$(document).ready(function () {
                    //    debugger;
                    //    LoadDoctorTimeTable();
                    //});
                    function LoadDoctorTimeTable() {
                        debugger;
                        var doctorID = '@ViewBag.DocID';
                        $.ajax({
                            type: 'POST',
                            data: { DoctorID: doctorID },
                            url: "@Url.Action("GetDoctorTimeTable","Patient")",
                            datatype: 'json',
                            success: function (json) {
                                debugger;
                                var tblEmployee = $("#tblEmployee");
                                tblEmployee.find("tr:gt(0)").remove();
                                //$("#DrName").html(json.DoctorName);
                                //$("#monday").html(json.StartingTime);
                                //$("#tuesday").html(json.StartingTime);
                                //$("#wednesday").html(json.StartingTime);
                                //$("#mondayE").html(json.EndingTime);
                                //$("#tuesdayE").html(json.EndingTime);
                                //$("#wednesdayE").html(json.EndingTime);

                                $.each(json, function (index, item) {
                                    debugger;
                                    $("#DrName").html(item.DoctorName);
                                    $("#tblEmployee").append("<tr><td class=\"text-center\"><strong>" + item.Name + "</strong></td>" + "<td class=\"text-center\"><strong>" + item.StartingTime + "</strong></td>" + " " + "<td colspan=\"2\" class=\"text-center\"><strong>" + item.EndingTime + "</strong></td ></tr > ");

                                    //var tr = $("<tr></tr>");
                                    //tr.html(

                                    //    + " " + ("<td>" + item.Name + "</td>")
                                    //    + " " + ("<td>" + item.StaringTime + "</td>")
                                    //    + " " + ("<td>" + item.EndingTime + "</td>"));


                                    //tblEmployee.append(tr);
                                });

                            }
                        });
                    }
                    function LoadSlot() {
                        debugger;
                        //var doctorID = $('#DoctorID').val();
                        var AppointmentDate = $('#AppointmentDate').val();

                        var doctorID = '@ViewBag.DocID';

                        var day = $('#Day').val();
                        var dayText = $('#Day').text();
                        $.ajax({
                            type: "POST",
                            data: { DoctorID: doctorID, AppointmentDate: AppointmentDate },
                            url: "@Url.Action("GetSlotDoctorWise", "Patient")",
                            datatype: 'json',
                            success: function (json) {
                                debugger;
                                $el = $("#Slot");
                                $el.empty();
                                //value = json.ID;
                                //key = json.Name;
                                $.each(json, function (value, key) {
                                    $el.append($("<option></option>").val(key.ID).text(key.Name));
                                });
                            }
                        });
                    }
                    $('#Day').click(function () {
                        debugger;
                        LoadDoctorTimeTable();
                        //LoadSlot();
                    });
                    $('#Department').change(function () {
                        //debugger;
                        var dept = $('#Department').val();
                        LoadDoctorDepartmentWise();
                    });
                    function LoadDoctorDepartmentWise() {
                        //debugger;
                        var DeptID = $('#Department').val();
                        $.ajax({
                            type: "POST",
                            data: { DepartmentID: DeptID },
                            url: "@Url.Action("GetDoctorDeptWise","Patient")",
                            datatype: 'json',
                            success: function (json) {
                                //debugger;
                                $el = $("#DoctorID");
                                $el.empty();
                                $.each(json, function (value, key) {

                                    $el.append($("<option></option>").val(key.EmpID).text(key.DoctorName));
                                });

                            }

                        });
                    }
                    function LoadDayDateWise() {
                        //debugger;
                        var AppointmentDate = $('#AppointmentDate').val();
                        $.ajax({
                            type: "POST",
                            data: { AppointmentDate: AppointmentDate },
                            url: "@Url.Action("GetDayDateWise", "Patient")",
                            datatype: 'json',
                            success: function (json) {
                                //debugger;
                                var $el = $("#Day");
                                $el.empty();
                                $('#Day').val(json);

                            }
                        });
                    }
                    $('#AppointmentDate').change(function () {
                        debugger;
                        var SelectedDate = $('#AppointmentDate').val();
                        //LoadDayDateWise();
                        LoadSlot();
                    });
                    $(document).ready(function () {
                        //$('#AppointmentDate').persianDatepicker({
                        //    observer: true,
                        //    format: 'YYYY/MM/DD',
                        //    min: [1396, 2, 10],
                        //    max: [1396, 2, 20],
                        //    minDate: new Date()
                        //}).pDatepicker('setDate', [today]);
               
                        var $dp1 = $("#AppointmentDate");
                        $dp1.datepicker({
                            changeYear: true,
                            changeMonth: true,
           
                            dateFormat: "yy-m-dd",
                            yearRange: "-100:+20",
                            minDate: new Date()
                        });
                        //debugger;
                        LoadDoctorTimeTable();

                    });
        </script>
        <script type="text/javascript">
                    
                    function ClearForm() {
                        $("#PatientName").val('');
                        $("#RelationName").val('');
                        $("#Age").val('');
                        $("#ConPass").val('');
                        $("#MobileNo").val('');
                        $("#Email").val('');
                    }
                    function OnSuccess(response) {
                        debugger;
                        if (response == "1") {
                            ClearForm();
                            alert("Patient Added Successfully");
                        }
                        else {
                            alertify.success("Patient Not Added");
                        }
                        ClearForm();
                    }
                    function OnFailure(response) {
                        debugger;
                        if (response == "1") {
                            //ClearForm();
                            alert("Patient Added Successfully");
                        }
                        else {
                            alertify.success("Patient Not Added");
                        }
                        ClearForm();
                    }
    </script>
</body>
</html>

